#include <cassert>

extern double U(double c[8], double xl);
extern double r(double H, double W, double N, double phi);

struct MainBody
{
    static double H(double xl);
    static double W(double xl);
    static double N(double xl);
    static double Z(double xl);
    static double yl(double xl, double phi);
    static double zl(double xl, double phi);
};

double MainBody::yl(double xl, double phi)
{
    return r(H(xl), W(xl), N(xl), phi) * std::sin(phi);
}

double MainBody::zl(double xl, double phi)
{
    return r(H(xl), W(xl), N(xl), phi) * std::cos(phi) + Z(xl);
}

double MainBody::H(double xl)
{
    double c[8];

    assert(xl >= 0.);
    
    /*if (xl < 0.4)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.4000;
        c[3] = 0.4000;
        c[4] = 1.8000;
        c[5] = 0.0000;
        c[6] = 0.3825;
        c[7] = 1.8000;
    }
    else if (xl < 0.96)
    {
        c[0] = 0.3825;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 1.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 1.40)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.9600;
        c[3] = 0.4400;
        c[4] = 3.0000;
        c[5] = 0.1500;
        c[6] = 0.2325;
        c[7] = 0.1800;
    }
    else if (xl < 1.90)
    {
        c[0] = 0.1500;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 2.00)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -1.9000;
        c[3] = 0.1000;
        c[4] = 2.0000;
        c[5] = 0.0000;
        c[6] = 0.1500;
        c[7] = 2.0000;
    }*/

    if (xl < 0.4)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.4;
        c[3] = 0.4;
        c[4] = 1.8;
        c[5] = 0.0;
        c[6] = 0.25;
        c[7] = 1.8;
    }
    else if (xl < 0.8)
    {
        c[0] = 0.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 0.25;
        c[6] = 0.0;
        c[7] = 0.0;
    }
    else if (xl < 1.9)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.8;
        c[3] = 1.1;
        c[4] = 1.5;
        c[5] = 0.05;
        c[6] = 0.2;
        c[7] = 0.6;
    }
    else if (xl < 2.0)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -1.9;
        c[3] = 0.1;
        c[4] = 2.0;
        c[5] = 0.0;
        c[6] = 0.05;
        c[7] = 2.0;
    }
    
    if (U(c, xl) == 0.)
    {
        std::cout << "xl: " << xl << std::endl;
        std::cout << "c[0]: " << c[0] << std::endl;
        std::cout << "c[1]: " << c[1] << std::endl;
        std::cout << "c[2]: " << c[2] << std::endl;
        std::cout << "c[3]: " << c[3] << std::endl;
        std::cout << "c[4]: " << c[4] << std::endl;
        std::cout << "c[5]: " << c[5] << std::endl;
        std::cout << "c[6]: " << c[6] << std::endl;
        std::cout << "c[7]: " << c[7] << std::endl;
    }
    return U(c, xl);
}

double MainBody::W(double xl)
{
    double c[8];

    assert(xl >= 0.);

    /*if (xl < 0.4)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.4000;
        c[3] = 0.4000;
        c[4] = 2.0000;
        c[5] = 0.0000;
        c[6] = 0.3275;
        c[7] = 2.0000;
    }
    else if (xl < 0.96)
    {
        c[0] = 0.3275;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 1.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 1.40)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.9600;
        c[3] = 0.4400;
        c[4] = 3.0000;
        c[5] = 0.1500;
        c[6] = 0.1775;
        c[7] = 0.1800;
    }
    else if (xl < 1.90)
    {
        c[0] = 0.1500;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 2.00)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -1.9000;
        c[3] = 0.1000;
        c[4] = 2.0000;
        c[5] = 0.0000;
        c[6] = 0.1500;
        c[7] = 2.0000;
    }*/

    if (xl < 0.4)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.4;
        c[3] = 0.4;
        c[4] = 2.0;
        c[5] = 0.0;
        c[6] = 0.25;
        c[7] = 2.0;
    }
    else if (xl < 0.8)
    {
        c[0] = 0.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 0.25;
        c[6] = 0.0;
        c[7] = 0.0;
    }
    else if (xl < 1.9)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.8;
        c[3] = 1.1;
        c[4] = 1.5;
        c[5] = 0.05;
        c[6] = 0.2;
        c[7] = 0.6;
    }
    else if (xl < 2.0)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -1.9;
        c[3] = 0.1;
        c[4] = 2.0;
        c[5] = 0.0;
        c[6] = 0.05;
        c[7] = 2.0;
    }

    return U(c, xl);
}

double MainBody::Z(double xl)
{
    double c[8];

    assert(xl >= 0.);

    /*if (xl < 0.4)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.4000;
        c[3] = 0.4000;
        c[4] = 1.8000;
        c[5] = -0.0800;
        c[6] = 0.0800;
        c[7] = 1.8000;
    }
    else if (xl < 0.96)
    {
        c[0] = 0.0000;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 1.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 1.40)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.9600;
        c[3] = 0.4400;
        c[4] = 3.0000;
        c[5] = 0.1163;
        c[6] = -0.1163;
        c[7] = 0.1800;
    }
    else if (xl < 1.90)
    {
        c[0] = 0.1163;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 2.00)
    {
        c[0] = 0.1163;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }*/

    if (xl < 0.4)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.4;
        c[3] = 0.4;
        c[4] = 1.8;
        c[5] = -0.08;
        c[6] = 0.08;
        c[7] = 1.8;
    }
    else if (xl < 0.8)
    {
        c[0] = 0.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 0.0;
        c[6] = 0.0;
        c[7] = 0.0;
    }
    else if (xl < 1.9)
    {
        c[0] = 1.0;
        c[1] = -1.0;
        c[2] = -0.8;
        c[3] = 1.1;
        c[4] = 1.5;
        c[5] = 0.04;
        c[6] = -0.04;
        c[7] = 0.6;
    }
    else if (xl < 2.0)
    {
        c[0] = 0.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 0.04;
        c[6] = 0.0;
        c[7] = 0.0;
    }

    return U(c, xl);
}

double MainBody::N(double xl)
{
    double c[8];

    assert(xl >= 0.);

    /*if (xl < 0.4)
    {
        c[0] = 2.0000;
        c[1] = 3.0000;
        c[2] = 0.0000;
        c[3] = 0.4000;
        c[4] = 1.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 0.96)
    {
        c[0] = 5.0000;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 1.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 1.40)
    {
        c[0] = 1.0000;
        c[1] = -1.0000;
        c[2] = -0.9600;
        c[3] = 0.4400;
        c[4] = 1.0000;
        c[5] = 2.0000;
        c[6] = 3.0000;
        c[7] = 0.5500;
    }
    else if (xl < 1.90)
    {
        c[0] = 2.0000;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }
    else if (xl < 2.00)
    {
        c[0] = 2.0000;
        c[1] = 0.0000;
        c[2] = 0.0000;
        c[3] = 0.0000;
        c[4] = 0.0000;
        c[5] = 0.0000;
        c[6] = 1.0000;
        c[7] = 1.0000;
    }*/

    if (xl < 0.4)
    {
        c[0] = 2.0;
        c[1] = 3.0;
        c[2] = 0.0;
        c[3] = 0.4;
        c[4] = 1.0;
        c[5] = 0.0;
        c[6] = 1.0;
        c[7] = 1.0;
    }
    else if (xl < 0.8)
    {
        c[0] = 0.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 5.0;
        c[6] = 0.0;
        c[7] = 0.0;
    }
    else if (xl < 1.9)
    {
        c[0] = 5.0;
        c[1] = -3.0;
        c[2] = -0.8;
        c[3] = 1.1;
        c[4] = 1.0;
        c[5] = 0.0;
        //c[6] = 0.0;
        //c[7] = 0.0;
        c[6] = 1.0;
        c[7] = 1.0;
    }
    else if (xl < 2.0)
    {
        c[0] = 2.0;
        c[1] = 0.0;
        c[2] = 0.0;
        c[3] = 0.0;
        c[4] = 0.0;
        c[5] = 0.0;
        //c[6] = 0.0;
        //c[7] = 0.0;
        c[6] = 1.0;
        c[7] = 1.0;
    }

    return U(c, xl);
}
